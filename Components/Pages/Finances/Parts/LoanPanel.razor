@namespace Hearth.Finances.Parts
@using Hearth.Icons
@using Hearth.Models

@if (Loans.Count() == 0)
{
	<div>no loan found</div>
}
else if(Loans.Count() >= 1)
{
	<div class="loan-panel">
		@* Loan Type and Toast *@
		<div class="lp-header">
			<div class="lp-h-header">
				<span class="lp-h-h-icon"><IconHome Size=30 /></span> Mortgage
			</div>
			<div class="lp-h-toast">
				<span class="lp-h-t-icon"><IconExlemation /></span> <span class="lp-h-t-text">payment due in 2 days</span>
			</div>
		</div>
		@* Loan Name and Payment *@
		<div class="lp-body">
			<div> <IconCaret Direction="l" Size="25" /> </div>

			<div class="lp-b-body">
				<h2 class="lp-b-b-header">
					
				</h2>
				<div class="lp-b-b-payment">
					$2,172 <span class="per-tag">/mo</span>
				</div>
			</div>

			<div> <IconCaret Direction="r" Size="25" /> </div>
		</div>
		@* Progress Bar *@
		<div class="lp-footer">
			@* The Num container rests exactly above the bar container *@
			<div class="lp-f-green-num-container">
				<div class="green-num">$75,000</div>
			</div>
			<div class="lp-f-bar-container">
				<div class="green-bar"></div>
				<div class="red-bar"></div>
			</div>
			<div class="lp-f-red-num-container">
				<div class="red-num">$324,000</div>
			</div>
		</div>
	</div>
}


@code{
	[Parameter] public List<Loan> Loans { get; set; } = new();
	[Parameter] public bool IsSmall { get; set; } = false;

	private int currentIndex = 0;

	private Loan CurrentLoan => Loans[currentIndex];

	private double ProgressPercentage =>
		CurrentLoan.TotalAmount > 0
			? Math.Round((double)CurrentLoan.AmountPaid / CurrentLoan.TotalAmount * 100, 2)
			: 0;

	private void NextLoan()
	{
		if (Loans.Count > 0)
		{
			currentIndex = (currentIndex + 1) % Loans.Count;
		}
	}

	private void PreviousLoan()
	{
		if (Loans.Count > 0)
		{
			currentIndex = (currentIndex - 1 + Loans.Count) % Loans.Count;
		}
	}
}